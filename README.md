# Blowing Simulator

A Go-based web application for processing and analyzing PDF reports from cable blowing operations. Supports both Jetting and Fremco PDF formats with intelligent parsing and data visualization.

## ğŸ“‹ Description

The Blowing Simulator is a comprehensive tool designed for telecommunications and utility companies that perform fiber optic cable installation using pneumatic cable blowing techniques. The application processes PDF protocol reports generated by cable blowing equipment and converts them into structured, analyzable data.

### What is Cable Blowing?

Cable blowing is a method for installing fiber optic cables into underground ducts using compressed air. During the installation process, specialized equipment monitors various parameters like:

- **Distance/Length**: How far the cable has been blown
- **Speed**: Rate of cable installation (m/min)  
- **Pressure**: Air pressure in the duct system (bar)
- **Torque**: Rotational force applied to the cable (%)
- **Temperature**: Environmental and equipment temperature (Â°C)
- **Force**: Pushing/pulling force applied (N)
- **Time**: Duration and timestamps of the operation

### Supported Equipment Formats

**Fremco Systems:**
- Fremco MicroFlow LOG equipment
- SpeedNet-System protocols
- Comprehensive equipment specifications (nozzles, pipes, cables, compressors)
- Weather data and GPS coordinates
- Detailed measurement logging with timestamps

**Jetting Systems:**
- Generic jetting equipment protocols
- German language field names (StreckenlÃ¤nge, Geschwindigkeit, etc.)
- Simplified equipment data structure
- High-frequency measurement capture

### Key Features

- **Automatic Format Detection**: Intelligently identifies whether a PDF is from Fremco or Jetting equipment
- **Dual Parsing Engines**: Uses appropriate extraction method for each format (pdftotext for Fremco, Go native for Jetting)
- **Database Integration**: Complete PostgreSQL database with comprehensive protocol storage
- **Protocol Management**: Searchable database of imported protocols with filtering and pagination
- **Measurement Viewer**: Detailed view of all measurement data points with pagination
- **Comprehensive Metadata**: Stores equipment specs, weather data, GPS coordinates, and complete protocol information
- **Web Interface**: Full-featured web application with modern UI
- **Data Export**: JSON and CSV export capabilities for further analysis
- **Report Generation**: PDF report creation from parsed data
- **Health Monitoring**: Built-in health checks and debugging endpoints

## ğŸš€ Quick Start

### Using Docker (Recommended)

```bash
# Clone the repository
git clone <repository-url>
cd blowing-simulator

# Start the application with Docker Compose (includes PostgreSQL database)
docker compose up -d

# Wait for database initialization (first run)
sleep 10

# Access the web interface
open http://localhost:8080
```

### Features Available

Once running, you can:

1. **Upload PDFs**: Process Fremco and Jetting protocol PDFs (single files)
2. **Bulk Upload**: Process multiple PDFs or entire directories at `/bulk-upload`
3. **View Protocols**: Browse all imported protocols at `/protocols`
4. **Search & Filter**: Find protocols by company, filename, or type
5. **Length Reports**: Analyze cable lengths over time at `/protocols/length-report`
6. **View Details**: See complete protocol information including equipment specs
7. **Browse Measurements**: View detailed measurement data with pagination
8. **Export Data**: Download data as JSON/CSV for external analysis
9. **Health Check**: Monitor application status at `/health`

### Manual Setup

```bash
# Install dependencies (Ubuntu/Debian)
sudo apt-get install poppler-utils postgresql

# Set up database
createdb blowing_simulator
psql -d blowing_simulator -f migrations/001_create_universal_schema.sql
psql -d blowing_simulator -f migrations/002_add_protocol_support.sql

# Build and run
go build -o blowing-simulator ./cmd/blowing-simulator
./blowing-simulator
```

## ğŸ“ Project Structure

```
blowing-simulator/
â”œâ”€â”€ cmd/blowing-simulator/          # Main application
â”‚   â”œâ”€â”€ main.go                     # Web server, PDF processing, protocol management
â”‚   â”œâ”€â”€ db.go                       # Legacy database operations
â”‚   â”œâ”€â”€ protocol_db.go              # Protocol database operations
â”‚   â””â”€â”€ download_json_handler.go    # Export functionality
â”œâ”€â”€ internal/                       # Core business logic
â”‚   â”œâ”€â”€ simulator/                  # PDF parsing engines & protocol structures
â”‚   â”‚   â”œâ”€â”€ parse_fremco.go        # Enhanced Fremco parser with metadata extraction
â”‚   â”‚   â”œâ”€â”€ parse_jetting.go       # Enhanced Jetting parser with German fields
â”‚   â”‚   â”œâ”€â”€ fremco_protocol.go     # Complete Fremco protocol structures
â”‚   â”‚   â”œâ”€â”€ jetting_protocol.go    # Complete Jetting protocol structures
â”‚   â”‚   â””â”€â”€ normalize.go           # Text normalization utilities
â”‚   â”œâ”€â”€ config/                    # Configuration management
â”‚   â”œâ”€â”€ fremco/                    # Fremco-specific logic
â”‚   â””â”€â”€ jetting/                   # Jetting-specific logic
â”œâ”€â”€ web/                           # Frontend components
â”‚   â”œâ”€â”€ templates/                 # HTML templates
â”‚   â”‚   â”œâ”€â”€ index.html             # Landing page with navigation
â”‚   â”‚   â”œâ”€â”€ pdf2text.html          # PDF processing interface
â”‚   â”‚   â”œâ”€â”€ protocols.html         # Protocol list with search/filter
â”‚   â”‚   â”œâ”€â”€ protocol-detail.html   # Individual protocol details
â”‚   â”‚   â”œâ”€â”€ protocol-measurements.html # Measurement data viewer
â”‚   â”‚   â”œâ”€â”€ create-fremco.html     # Fremco report creation
â”‚   â”‚   â”œâ”€â”€ create-jetting.html    # Jetting report creation
â”‚   â”‚   â””â”€â”€ report/                # Report templates
â”‚   â””â”€â”€ static/                    # CSS, JS, fonts
â”œâ”€â”€ migrations/                    # Database schema migrations
â”‚   â”œâ”€â”€ 001_create_universal_schema.sql    # Initial schema
â”‚   â””â”€â”€ 002_add_protocol_support.sql       # Protocol tables
â”œâ”€â”€ schema/                        # JSON schema templates
â”œâ”€â”€ docker-compose.yml             # Multi-container setup (app + PostgreSQL)
â”œâ”€â”€ Dockerfile                     # Container configuration
â””â”€â”€ README.md                      # This comprehensive guide
```

## ğŸ” Supported PDF Formats

### Jetting PDFs
- **Extraction Method**: Go native library (`github.com/ledongthuc/pdf`)
- **Data Format**: Vertical columns or individual lines
- **Fields**: German field names (LÃ¤nge[m], Lufttemperatur[Â°C], etc.)
- **Example Filename**: `29.10.2025, 11 20, Eiermarkt 15 B NVT 1V2200.pdf`

### Fremco PDFs  
- **Extraction Method**: pdftotext CLI tool with `-layout` flag
- **Data Format**: Horizontal table format
- **Fields**: English field names (Length, Speed, Pressure, etc.)
- **Example Filename**: `SM209214964_2025-10-22 10_51_Oldenburger Koppel_10_NVT1V3400.pdf`

## ğŸ—„ï¸ Database Integration

### PostgreSQL Schema

The application uses a comprehensive PostgreSQL database with four main tables:

- **`protocols`**: Main protocol information (system, date, company, operator, etc.)
- **`protocol_equipment`**: Equipment specifications (devices, pipes, cables, compressors)
- **`protocol_summary`**: Summary data (distances, times, weather, GPS coordinates)
- **`protocol_measurements`**: Individual measurement points (length, speed, pressure, etc.)

### Protocol Storage

Each uploaded PDF is parsed and stored as a complete protocol record:

```sql
-- Example protocol record
INSERT INTO protocols (protocol_type, system_name, company, source_filename, ...)
VALUES ('fremco', 'SpeedNet-System', 'Wolken-ASM GmbH', 'protocol.pdf', ...);

-- Associated equipment data
INSERT INTO protocol_equipment (protocol_id, device_model, compressor_model, ...)
VALUES (1, 'Fremco MicroFlow LOG', 'Atlas Copco GA500', ...);

-- Individual measurements (can be hundreds of data points)
INSERT INTO protocol_measurements (protocol_id, length_m, speed_m_min, pressure_bar, ...)
VALUES (1, 25.5, 30.2, 8.5, ...);
```

### Automatic Data Extraction

When a PDF is uploaded, the system automatically:

1. **Detects Format**: Fremco vs Jetting based on content analysis
2. **Extracts Metadata**: Company info, project details, equipment specs
3. **Parses Measurements**: All data points with proper type conversion
4. **Stores Weather/GPS**: Environmental data when available
5. **Creates Relations**: Links equipment, summary, and measurements to protocol

## ğŸŒ Web Interface Features

### Main Dashboard (`/`)
- Upload PDF files for processing
- Quick access to protocol database
- Navigation to report creation tools

### Protocol Management (`/protocols`)
- **Searchable Database**: Find protocols by company, filename, project number
- **Filter by Type**: View only Fremco or Jetting protocols
- **Pagination**: Handle large numbers of protocols efficiently
- **Quick Actions**: Direct links to view details or measurements

### Protocol Details (`/protocols/view?id=X`)
- **Complete Overview**: All protocol information in organized sections
- **Equipment Specifications**: Device models, serial numbers, configurations
- **Summary Data**: Total distances, durations, weather conditions, GPS coordinates
- **Measurement Count**: Number of data points with link to detailed view

### Measurement Viewer (`/protocols/measurements?id=X`)
- **Paginated Data**: Browse through hundreds/thousands of measurement points
- **Complete Fields**: Length, speed, pressure, torque, temperature, force, timestamps
- **Formatted Display**: Proper decimal formatting and null value handling
- **Navigation**: Easy browsing with previous/next page controls

### PDF Processing (`/pdf2text`)
- **Dual Format Support**: Handles both Fremco and Jetting PDFs
- **Live Feedback**: Real-time processing status
- **Format Detection**: Automatic identification with visual indicators
- **Data Preview**: View extracted measurements before saving
- **Export Options**: Download as JSON or CSV

## ğŸ“Š Data Processing Pipeline

1. **PDF Upload**: User selects PDF file through web interface
2. **Format Detection**: System analyzes content to identify Fremco/Jetting format
3. **Text Extraction**: Uses appropriate method (pdftotext for Fremco, Go native for Jetting)
4. **Metadata Extraction**: Parses header information, equipment specs, project details
5. **Measurement Parsing**: Converts tabular data to structured format
6. **Database Storage**: Saves complete protocol with all relationships
7. **Web Display**: Shows parsed data in user-friendly interface
8. **Export Options**: Provides JSON/CSV downloads for external analysis

## ğŸ¯ Key Features

### Intelligent Format Detection
```go
// Fremco indicators (processed first - higher priority)
if strings.Contains(rawStr, "Streckenabschnitt") || 
   strings.Contains(rawStr, "Fremco") ||
   strings.Contains(rawStr, "StreckenlÃ¤nge [m]") {
   // Use pdftotext extraction
}

// Jetting indicators  
if strings.Contains(rawStr, "LÃ¤nge") && 
   strings.Contains(rawStr, "Schubkraft") {
   // Use Go native extraction
}
```

### Dual Parser Architecture
- **SimpleMeasurement**: Fremco format (5 columns)
- **JettingMeasurement**: Jetting format (6 columns with German fields)

### Smart Data Display
- Shows `0.0` values when actual zeros exist
- Hides empty cells for missing data
- Dynamic table headers based on format
- Responsive chart visualization

## ğŸ”§ Configuration

### Environment Variables

The application supports the following environment variables:

```bash
# Database Configuration
DB_HOST=localhost          # Database host (default: localhost)
DB_PORT=5432              # Database port (default: 5432)  
DB_USER=blowing           # Database username (default: blowing)
DB_PASSWORD=password      # Database password (default: 7fG2vQp9sXw3Lk8r)
DB_NAME=blowing_simulator # Database name (default: blowing_simulator)

# Application Configuration  
PORT=8080                 # Web server port (default: 8080)
```

### Docker Compose Services

The application runs as a multi-container setup:

```yaml
services:
  app:
    build: .
    ports:
      - "8080:8080"
    environment:
      - DB_HOST=db
      - DB_PORT=5432
      - DB_USER=blowing
      - DB_PASSWORD=7fG2vQp9sXw3Lk8r
      - DB_NAME=blowing_simulator
    depends_on:
      - db

  db:
    image: postgres:15
    environment:
      - POSTGRES_USER=blowing
      - POSTGRES_PASSWORD=7fG2vQp9sXw3Lk8r  
      - POSTGRES_DB=blowing_simulator
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
```

### Database Schema

The database uses two migration files:

1. **`001_create_universal_schema.sql`**: Legacy measurement tables
2. **`002_add_protocol_support.sql`**: Complete protocol support with:
   - Protocol metadata table
   - Equipment specifications table  
   - Summary data with weather/GPS
   - Comprehensive measurements table with all field types

### First Run Setup

On first run, the database will be automatically initialized. You can also run migrations manually:

```bash
# Execute migrations in order
docker exec -i blowing-simulator-db-1 psql -U blowing -d blowing_simulator < migrations/001_create_universal_schema.sql
docker exec -i blowing-simulator-db-1 psql -U blowing -d blowing_simulator < migrations/002_add_protocol_support.sql
```

## ğŸ“ˆ Usage Guide

### Complete Workflow Example

#### 1. Upload and Process PDF
```bash
# Navigate to the application
open http://localhost:8080

# Upload a PDF file
# - Select Fremco or Jetting PDF
# - Click "Export Report" 
# - System automatically detects format and processes
```

#### 2. View Processed Data
- **Immediate Preview**: See extracted measurements in web interface
- **Format Detection**: Visual indicator shows detected format (Fremco/Jetting)
- **Data Validation**: Review parsed data before saving
- **Export Options**: Download JSON or CSV immediately

#### 3. Database Storage
The system automatically saves:
- **Protocol Information**: Date, time, project number, company details
- **Equipment Data**: Device models, serial numbers, specifications
- **Environmental Data**: Weather conditions, GPS coordinates (when available)
- **Measurement Points**: All data points with proper field mapping

#### 4. Browse Protocol Database
```bash
# View all protocols
http://localhost:8080/protocols

# Search by company
http://localhost:8080/protocols?search=Wolken-ASM

# Filter by type
http://localhost:8080/protocols?type=fremco
```

#### 5. Analyze Detailed Data
```bash
# View protocol details
http://localhost:8080/protocols/view?id=1

# Browse measurement data
http://localhost:8080/protocols/measurements?id=1
```

### Processing Different PDF Types

#### Jetting PDFs
- **Detection**: Contains keywords like "LÃ¤nge", "Schubkraft", "Lufttemperatur"
- **Extraction**: Go native library for reliable text extraction
- **Fields**: German language (StreckenlÃ¤nge, Geschwindigkeit, etc.)
- **Data Points**: Typically high-frequency measurements (hundreds of points)

#### Fremco PDFs
- **Detection**: Contains "Fremco", "Streckenabschnitt", "SpeedNet-System"
- **Extraction**: pdftotext CLI for precise table extraction
- **Fields**: English language (Length, Speed, Pressure, etc.)
- **Metadata**: Rich equipment specifications and environmental data

### Database Queries

You can also query the database directly:

```sql
-- View all protocols
SELECT id, protocol_type, company, source_filename, created_at 
FROM protocols ORDER BY created_at DESC;

-- Get measurement count by protocol
SELECT p.id, p.source_filename, COUNT(m.id) as measurement_count
FROM protocols p
LEFT JOIN protocol_measurements m ON p.id = m.protocol_id
GROUP BY p.id, p.source_filename;

-- Find protocols by company
SELECT * FROM protocols WHERE company ILIKE '%wolken%';
```

## ğŸ›  Development

### Adding New PDF Formats
1. Add detection logic in `main.go`
2. Create new parser in `internal/simulator/`
3. Define measurement structure
4. Update frontend templates

### Database Schema
See `migrations/001_create_universal_schema.sql` for complete schema.

## ğŸ› Troubleshooting

### Application Issues

#### "pdftotext: executable file not found"
```bash
# Docker (should be automatic)
docker compose up -d --build

# Manual installation
sudo apt-get update
sudo apt-get install poppler-utils
```

#### "Database connection failed"
```bash
# Check if database container is running
docker compose ps

# Check database logs
docker compose logs db

# Restart database
docker compose restart db
```

#### "No measurement data found"
1. **Check PDF Format**: Ensure PDF contains expected text structure
2. **View Raw Text**: Check "Extracted Text (Raw)" section in web interface
3. **Format Detection**: Verify correct format is detected (Fremco/Jetting)
4. **Check Logs**: `docker compose logs app`

### Web Interface Issues

#### "Protocol not found" errors
```bash
# Check database content
docker exec -i blowing-simulator-db-1 psql -U blowing -d blowing_simulator -c "SELECT id, source_filename FROM protocols;"

# Verify protocol ID exists
curl http://localhost:8080/protocols
```

#### "Template rendering errors"
- Check application logs for specific template errors
- Ensure all template files exist in `web/templates/`
- Restart application: `docker compose restart app`

#### Reverse Proxy Issues (for production deployments)
If using reverse proxy (nginx, frp, etc.):

```bash
# Test direct access first
curl http://localhost:8080/health

# Check proxy configuration
# Ensure all routes are forwarded: /, /protocols, /protocols/view, /protocols/measurements

# Test specific endpoints
curl https://your-domain.com/health
curl https://your-domain.com/protocols
```

### Database Issues

#### Migration failures
```bash
# Check migration status
docker exec -i blowing-simulator-db-1 psql -U blowing -d blowing_simulator -c "\dt"

# Re-run migrations manually
docker exec -i blowing-simulator-db-1 psql -U blowing -d blowing_simulator < migrations/001_create_universal_schema.sql
docker exec -i blowing-simulator-db-1 psql -U blowing -d blowing_simulator < migrations/002_add_protocol_support.sql
```

#### Data integrity issues
```bash
# Check for orphaned records
docker exec -i blowing-simulator-db-1 psql -U blowing -d blowing_simulator -c "
SELECT p.id, COUNT(m.id) as measurements 
FROM protocols p 
LEFT JOIN protocol_measurements m ON p.id = m.protocol_id 
GROUP BY p.id;"
```

### Performance Issues

#### Slow measurement loading
- **Pagination**: Measurement viewer uses 50 items per page
- **Indexing**: Database has proper indexes on protocol_id fields
- **Memory**: Ensure sufficient container memory for large datasets

#### Large PDF processing
- **Timeout**: Increase processing timeout for very large PDFs
- **Memory**: Monitor container memory usage during processing
- **Disk Space**: Ensure sufficient space for temporary files

### Development Issues

#### ARM64 Compatibility
- Application builds natively for ARM64 (Apple Silicon, Raspberry Pi)
- All dependencies support ARM64 architecture
- Docker images are multi-architecture

#### Go Module Issues
```bash
# Clean and rebuild
go mod tidy
go mod download
docker compose up -d --build
```

### Health Check Endpoint

Monitor application status:
```bash
# Application health
curl http://localhost:8080/health

# Expected response:
# {"status": "healthy", "timestamp": "2025-11-15T17:37:43Z", "routes": [...]}
```

### Log Analysis

View detailed logs for debugging:
```bash
# Application logs
docker compose logs -f app

# Database logs  
docker compose logs -f db

# All logs
docker compose logs -f
```

## ğŸ¯ Complete Feature Set

### PDF Processing
- âœ… **Dual Format Support**: Fremco and Jetting PDFs
- âœ… **Automatic Detection**: Intelligent format identification
- âœ… **Robust Extraction**: pdftotext for Fremco, Go native for Jetting
- âœ… **Metadata Parsing**: Equipment specs, weather data, GPS coordinates
- âœ… **Error Handling**: Graceful handling of malformed PDFs

### Database Integration  
- âœ… **PostgreSQL Storage**: Complete protocol persistence
- âœ… **Relational Schema**: Equipment, summary, measurements tables
- âœ… **Transaction Safety**: ACID compliance for data integrity
- âœ… **Migration Support**: Versioned database schema updates
- âœ… **Data Validation**: Type checking and constraint enforcement

### Web Interface
- âœ… **Modern UI**: Responsive design with intuitive navigation
- âœ… **Protocol Management**: Searchable database with filtering
- âœ… **Detailed Views**: Complete protocol information display
- âœ… **Measurement Viewer**: Paginated data browser with 50 items/page
- âœ… **Real-time Processing**: Live feedback during PDF processing
- âœ… **Export Options**: JSON and CSV download capabilities

### System Architecture
- âœ… **Containerized**: Docker Compose with PostgreSQL
- âœ… **Health Monitoring**: Built-in health checks and debugging
- âœ… **Multi-Architecture**: Native ARM64 and x86_64 support
- âœ… **Production Ready**: Reverse proxy compatible
- âœ… **Scalable Design**: Efficient database queries with pagination

### Data Management
- âœ… **Comprehensive Storage**: All protocol data preserved
- âœ… **Search & Filter**: Find protocols by multiple criteria
- âœ… **Measurement Analytics**: Access to individual data points
- âœ… **Format Preservation**: Original structure maintained
- âœ… **Export Flexibility**: Multiple output formats

## ğŸ“ Technologies Used

- **Backend**: Go 1.24.4, net/http standard library
- **Database**: PostgreSQL 15 with sqlx for enhanced SQL operations
- **PDF Processing**: pdftotext (Poppler), ledongthuc/pdf Go library
- **Frontend**: HTML5, CSS3, JavaScript (vanilla), responsive design
- **Containerization**: Docker & Docker Compose multi-container setup
- **Architecture**: Multi-architecture support (ARM64, x86_64)
- **Development**: Native Go modules, structured project layout

## ğŸ—ºï¸ API Routes

### Main Application Routes

| Route | Method | Description |
|-------|--------|-------------|
| `/` | GET | Main landing page with navigation |
| `/pdf2text` | GET/POST | PDF processing interface with database storage |
| `/health` | GET | Application health check (JSON response) |

### Protocol Management Routes

| Route | Method | Description |
|-------|--------|-------------|
| `/protocols` | GET | Searchable protocol database with filtering |
| `/protocols/view?id=X` | GET | Detailed protocol information and metadata |
| `/protocols/measurements?id=X` | GET | Paginated measurement data viewer |
| `/protocols/length-report` | GET | Length analysis report with date/format filtering |

### Bulk Processing Routes

| Route | Method | Description |
|-------|--------|-------------|
| `/bulk-upload` | GET | Bulk PDF upload interface with directory support |
| `/bulk-upload` | POST | Process multiple PDF files with progress tracking |

### Report Creation Routes

| Route | Method | Description |
|-------|--------|-------------|
| `/create-fremco` | GET/POST | Fremco report creation interface |
| `/create-jetting` | GET/POST | Jetting report creation interface |
| `/edit-report` | GET/POST | Edit existing report data |
| `/jetting-report` | GET | View generated Jetting reports |

### Export and Download Routes

| Route | Method | Description |
|-------|--------|-------------|
| `/download-json` | POST | Export processed data as JSON |
| `/download-csv` | POST | Export processed data as CSV |
| `/download-pdf` | POST | Export as PDF report |
| `/export-pdf` | POST | Generate PDF from protocol data |
| `/export-csv` | POST | Generate CSV export |

### Static Assets

| Route | Method | Description |
|-------|--------|-------------|
| `/static/*` | GET | CSS, JavaScript, fonts, and images |

## ğŸ“‹ Measurement Data Structures

### Jetting Format (German)
```go
type JettingMeasurement struct {
    Length      float64 `json:"lÃ¤nge_m"`                    // LÃ¤nge[m]
    Temperature float64 `json:"lufttemperatur_c"`           // Lufttemperatur[Â°C]
    Force       float64 `json:"schubkraft_n"`               // Schubkraft[N]
    Pressure    float64 `json:"einblasdruck_bar"`           // Einblasdruck[bar]
    Speed       float64 `json:"geschwindigkeit_m_min"`      // Geschwindigkeit[m/min]
    Time        string  `json:"zeit_dauer_hh_mm_ss"`        // Zeit - Dauer[hh:mm:ss]
}
```

### Fremco Format (English)
```go
type SimpleMeasurement struct {
    Length   float64 `json:"length"`   // StreckenlÃ¤nge [m]
    Speed    float64 `json:"speed"`    // Geschwindigkeit [m/min]
    Pressure float64 `json:"pressure"` // Rohr-Druck [bar]
    Torque   float64 `json:"torque"`   // Drehmoment [%]
    Time     string  `json:"time"`     // Uhrzeit [hh:mm:ss]
}
```

## ğŸ¨ Frontend Features

- **Responsive Design**: Works on desktop and mobile
- **Dynamic Tables**: Auto-adjusting columns based on format
- **Interactive Charts**: Multi-axis visualization with Chart.js
- **Real-time Processing**: Live feedback during PDF processing
- **Export Options**: JSON, CSV download buttons

### Length Report (`/protocols/length-report`)
- **Date Range Filtering**: Select start and end dates for analysis period
- **Format Selection**: Choose Fremco, Jetting, or both protocol types using checkboxes
- **Summary Statistics**: 
  - Total protocols in selected date range
  - Total measurements across all protocols
  - Maximum length value found in dataset
  - Average length across all measurements
- **Detailed Protocol Table**: Shows per-protocol statistics including:
  - Protocol date, type (color-coded), company, service provider
  - Min/Max/Average length measurements per protocol
  - Measurement count per protocol
  - Source filename and action buttons
- **CSV Export**: One-click export of length report data for external analysis
- **Smart Defaults**: Automatically sets to last 30 days if no date range specified

### Bulk Upload (`/bulk-upload`)
- **Multiple Upload Methods**:
  - **Drag & Drop Interface**: Drag multiple PDF files directly into the browser
  - **File Browser Selection**: Multi-select PDFs using Ctrl+Click or Shift+Click
  - **Directory Upload**: Select entire directories including all subdirectories with PDF files
- **Upload Configuration Options**:
  - âœ… **Skip Existing Files**: Automatically bypass files already in database (prevents duplicates)
  - âœ… **Auto-Save to Database**: Immediately save parsed protocols to database after processing
  - âœ… **Continue on Errors**: Keep processing remaining files even if individual files fail
  - âœ… **Show Preview**: Display parsing results before database commit
- **Real-Time Progress Tracking**:
  - Visual progress bar with percentage completion
  - Current file being processed indicator
  - File count progress (e.g., "Processing file 15 of 47")
  - Estimated time remaining display
- **Concurrent Processing**: Processes up to 5 files simultaneously for faster throughput
- **Comprehensive Results Display**:
  - Success/failure summary with counts
  - Per-file detailed results showing:
    - Format detected (Fremco/Jetting with color coding)
    - Number of measurements successfully parsed
    - Database save status confirmation
    - Specific error messages for failed files
  - Files skipped due to existing database records
- **Error Handling**: Graceful handling of PDF extraction failures, parsing errors, and database issues
- **Memory Efficient**: Streams files without loading entire collections into memory

### Advanced Features

#### Smart Format Detection
The system uses content analysis to automatically identify PDF formats:

```go
// Jetting format indicators
func isJettingFormat(text string) bool {
    return (strings.Contains(text, "LÃ¤nge") && 
            strings.Contains(text, "m/min") && 
            strings.Contains(text, "Uhrzeit")) ||
           (strings.Contains(text, "StreckenlÃ¤nge") && 
            strings.Contains(text, "Drehmoment") && 
            !strings.Contains(text, "Fremco"))
}

// Fremco format indicators  
func isFremcoFormat(text string) bool {
    return strings.Contains(text, "Fremco") || 
           (strings.Contains(text, "Blowing distance") && 
            strings.Contains(text, "Blowing time"))
}
```

#### Database Integration Architecture
- **Transaction-Based Operations**: Ensures data consistency during bulk operations
- **Duplicate Prevention**: MD5 hashing and filename checking to avoid duplicates
- **Relationship Management**: Automatic linking of protocols, equipment, summary, and measurements
- **NULL Handling**: Proper SQL NULL types for optional fields
- **Performance Optimization**: Batch inserts for large measurement datasets

#### Export and Reporting
- **Length Analysis**: Statistical analysis of cable installation distances over time
- **CSV Export**: Structured data export for spreadsheet analysis
- **JSON Format**: Machine-readable format for integration with other systems
- **Filtered Reports**: Generate reports based on date ranges, companies, or equipment types

## ğŸ“š Documentation

- **Database Schema**: See [`database.md`](./database.md)
- **API Documentation**: Route handlers in `cmd/blowing-simulator/main.go`
- **Parser Logic**: Individual parsers in `internal/simulator/`

## ğŸ¤ Contributing

### Development Setup
1. Fork the repository
2. Clone your fork: `git clone https://github.com/your-username/blowing-simulator.git`
3. Create a feature branch: `git checkout -b feature-name`
4. Make your changes with proper testing
5. Submit a pull request with detailed description

### Areas for Contribution
- **Parser Enhancement**: Support for additional PDF formats
- **Database Optimization**: Query performance improvements
- **UI/UX**: Frontend enhancements and accessibility
- **Testing**: Unit tests and integration tests
- **Documentation**: Code comments and user guides
- **Performance**: Optimization for large datasets

### Code Style
- Follow Go best practices and gofmt formatting
- Add comprehensive comments for new functions
- Include error handling for all operations
- Write tests for new parsing logic

## ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.

---

## ğŸ“ Support

For questions, issues, or contributions:
- **Issues**: Create GitHub issues for bugs or feature requests
- **Documentation**: Check this README for comprehensive guidance
- **Health Check**: Use `/health` endpoint to verify application status
- **Logs**: Use `docker compose logs` for debugging information

**Version**: 2.1.0 with bulk upload, length reporting, and advanced protocol management
**Last Updated**: November 2025
**Compatibility**: Go 1.24+, PostgreSQL 15+, Docker Compose 2.0+

### Recent Updates (v2.1.0)
- âœ… **Bulk PDF Upload**: Process directories and multiple files simultaneously
- âœ… **Length Report Analysis**: Statistical analysis of cable lengths with date/format filtering
- âœ… **Enhanced Protocol Management**: Improved search, filtering, and pagination
- âœ… **CSV Export**: Export length reports and protocol data for external analysis
- âœ… **Progress Tracking**: Real-time progress bars for bulk operations
- âœ… **Smart Duplicate Detection**: Automatic skip of files already in database
